{% extends "base.html" %}

{% block title %}{{ cat.name }}{% endblock %}

{% block content %}
<div class="bg-white shadow rounded-lg p-6">


    <!-- Lightbox -->
    <!-- <div x-data="{
            active: 0,
            lightbox: false,
        }">
        <div x-show="lightbox" x-transition
            class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50"
            @click.self="lightbox = false">
            <div class="relative max-w-3xl w-full px-4">
                <img :src="images[active].url" class="w-full max-h-[90vh] object-contain rounded">
                <button @click="lightbox = false" class="absolute top-4 right-4 text-white text-3xl">
                    &times;
                </button>
            </div>
        </div>
    </div> -->

    <!-- Back button -->
    <a href="/cats/" class="bg-cyan-600 text-white px-4 py-1 rounded-full hover:bg-purple-700 text-sm">
        <i class="fa-solid fa-angle-left"></i> Back
    </a>

    <!-- Edit Cat (if authenticated) -->
    {% if user.is_authenticated %}
    <a href="{% url 'cat_edit' cat.pk %}"
        class="ml-2 mt-4 px-4 py-1 bg-yellow-500 text-white rounded-full hover:bg-yellow-600 text-sm">
        <i class="fa-solid fa-pen-to-square"></i> Edit
    </a>
    {% endif %}

    <!-- Name -->
    <h2 class="mt-4 w-full text-center md:text-left text-xl font-semibold text-purple-700">
        <i class="fa-solid fa-heart"></i>
        {{ cat.name }}
        <i class="fa-solid fa-heart"></i>
    </h2>


    <div class="flex flex-col md:flex-row md:items-start md:space-x-4 mt-4">
        <img src="{{ cat.primary_image.image.url }}" class="block max-h-[400px] object-cover rounded-lg shadow mb-4">
        <div class="mt-4 md:mt-0 md:w-2/3 text-left">
            <p><strong>Breed:</strong> {{ cat.breed }}</p>
            <p><strong>Age:</strong> {{ cat.age }}</p>
            <p><strong>Colour:</strong> {{ cat.colour }}</p>
            <p><strong>Sex:</strong> {{ cat.get_sex_display }}</p>
            <p><strong>Status:</strong> {{ cat.get_status_display }}</p>
            <p><strong>Fostered In:</strong> {{ cat.fostered_in }}</p>
        </div>
    </div>

    <!-- Main Description -->
    <div class="mt-4">
        <h2 class="text-xl font-semibold mb-2">Description</h2>
        <p>{{ cat.description|linebreaks }}</p>
    </div>

    <!-- Health and compatibility -->
    <div class="mt-4 space-y-2 grid-cols-2">
        <!-- Vaccinated -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_vaccinated %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Vaccinated</strong>
                {% if cat.vaccinated_notes %}
                <p class="text-gray-600 text-sm">{{ cat.vaccinated_notes }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Microchipped -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_microchipped %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Microchipped</strong>
            </div>
        </div>

        <!-- Sterilised -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_sterilised %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Sterilised</strong>
            </div>
        </div>

        <!-- FIV -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_fiv_positive %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>FIV Status</strong>
                {% if cat.health_notes %}
                <p class="text-gray-600 text-sm">{{ cat.health_notes }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Good with kids -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_good_with_kids %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Good with kids</strong>
                {% if cat.good_with_kids_notes %}
                <p class="text-gray-600 text-sm">{{ cat.good_with_kids_notes }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Good with dogs -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_good_with_dogs %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Good with dogs</strong>
                {% if cat.good_with_dogs_notes %}
                <p class="text-gray-600 text-sm">{{ cat.good_with_dogs_notes }}</p>
                {% endif %}
            </div>
        </div>

        <!-- Good with cats -->
        <div class="flex items-start gap-3">
            <span class="text-xl">
                {% if cat.is_good_with_cats %}✓{% else %}✗{% endif %}
            </span>
            <div>
                <strong>Good with cats</strong>
                {% if cat.good_with_cats_notes %}
                <p class="text-gray-600 text-sm">{{ cat.good_with_cats_notes }}</p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Photo grid -->
    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {% for img in cat.images.all %}
        <div class="overflow-hidden">
            <img class="h-full w-full object-cover rounded-lg shadow-lg" src="{{ img.image.url }}"
                alt="{{ img.alt_text }}">
        </div>
        {% endfor %}
    </div>

</div>
{% endblock %}